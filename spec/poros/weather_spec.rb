require 'rails_helper'
RSpec.describe Weather do
  before :each do
    data = {:current_weather=>
  {:dt=>1619381136,
   :sunrise=>1619352457,
   :sunset=>1619401664,
   :temp=>75.49,
   :feels_like=>73.72,
   :pressure=>1003,
   :humidity=>21,
   :dew_point=>32.86,
   :uvi=>7.43,
   :clouds=>10,
   :visibility=>10000,
   :wind_speed=>1.01,
   :wind_deg=>302,
   :wind_gust=>5.01,
   :weather=>[{:id=>800, :main=>"Clear", :description=>"clear sky", :icon=>"01d"}]},
 :daily_weather=>
  [{:dt=>1619373600,
    :sunrise=>1619352457,
    :sunset=>1619401664,
    :moonrise=>1619396220,
    :moonset=>1619350440,
    :moon_phase=>0.44,
    :temp=>{:day=>73.06, :min=>47.25, :max=>75.63, :night=>63.09, :eve=>74.84, :morn=>47.25},
    :feels_like=>{:day=>70.95, :night=>46.13, :eve=>72.68, :morn=>46.13},
    :pressure=>1002,
    :humidity=>19,
    :dew_point=>28.81,
    :wind_speed=>13.98,
    :wind_deg=>203,
    :wind_gust=>19.82,
    :weather=>[{:id=>801, :main=>"Clouds", :description=>"few clouds", :icon=>"02d"}],
    :clouds=>17,
    :pop=>0.07,
    :uvi=>7.98},
   {:dt=>1619460000,
    :sunrise=>1619438778,
    :sunset=>1619488125,
    :moonrise=>1619487240,
    :moonset=>1619438580,
    :moon_phase=>0.5,
    :temp=>{:day=>71.87, :min=>52.65, :max=>77.38, :night=>60.82, :eve=>73.83, :morn=>52.65},
    :feels_like=>{:day=>69.13, :night=>48.74, :eve=>71.33, :morn=>48.74},
    :pressure=>995,
    :humidity=>8,
    :dew_point=>9.75,
    :wind_speed=>16.78,
    :wind_deg=>252,
    :wind_gust=>17.4,
    :weather=>[{:id=>802, :main=>"Clouds", :description=>"scattered clouds", :icon=>"03d"}],
    :clouds=>40,
    :pop=>0,
    :uvi=>7.82},
   {:dt=>1619546400,
    :sunrise=>1619525100,
    :sunset=>1619574586,
    :moonrise=>1619578320,
    :moonset=>1619526900,
    :moon_phase=>0.52,
    :temp=>{:day=>61.68, :min=>43.66, :max=>62.64, :night=>43.66, :eve=>48.22, :morn=>52.16},
    :feels_like=>{:day=>58.53, :night=>47.97, :eve=>42.6, :morn=>47.97},
    :pressure=>1000,
    :humidity=>21,
    :dew_point=>21.4,
    :wind_speed=>17.18,
    :wind_deg=>20,
    :wind_gust=>17.63,
    :weather=>[{:id=>502, :main=>"Rain", :description=>"heavy intensity rain", :icon=>"10d"}],
    :clouds=>15,
    :pop=>0.92,
    :rain=>13.6,
    :uvi=>7.05},
   {:dt=>1619632800,
    :sunrise=>1619611423,
    :sunset=>1619661047,
    :moonrise=>1619669460,
    :moonset=>1619615580,
    :moon_phase=>0.56,
    :temp=>{:day=>52.93, :min=>38.26, :max=>59.4, :night=>54.54, :eve=>59.4, :morn=>38.26},
    :feels_like=>{:day=>49.91, :night=>34.36, :eve=>56.5, :morn=>34.36},
    :pressure=>1017,
    :humidity=>42,
    :dew_point=>30.36,
    :wind_speed=>10.27,
    :wind_deg=>0,
    :wind_gust=>10.47,
    :weather=>[{:id=>803, :main=>"Clouds", :description=>"broken clouds", :icon=>"04d"}],
    :clouds=>65,
    :pop=>0.76,
    :uvi=>7.72},
   {:dt=>1619719200,
    :sunrise=>1619697747,
    :sunset=>1619747508,
    :moonrise=>1619760420,
    :moonset=>1619704620,
    :moon_phase=>0.6,
    :temp=>{:day=>65.53, :min=>46.02, :max=>70.74, :night=>63.55, :eve=>70.63, :morn=>46.02},
    :feels_like=>{:day=>62.64, :night=>43.93, :eve=>68.23, :morn=>43.93},
    :pressure=>1019,
    :humidity=>18,
    :dew_point=>21.65,
    :wind_speed=>6.24,
    :wind_deg=>81,
    :wind_gust=>9.51,
    :weather=>[{:id=>800, :main=>"Clear", :description=>"clear sky", :icon=>"01d"}],
    :clouds=>0,
    :pop=>0.04,
    :uvi=>9.1}],
 :hourly_weather=>
  [{:dt=>1619380800,
    :temp=>75.49,
    :feels_like=>73.72,
    :pressure=>1003,
    :humidity=>21,
    :dew_point=>32.86,
    :uvi=>7.43,
    :clouds=>10,
    :visibility=>10000,
    :wind_speed=>5.75,
    :wind_deg=>39,
    :wind_gust=>11.74,
    :weather=>[{:id=>800, :main=>"Clear", :description=>"clear sky", :icon=>"01d"}],
    :pop=>0},
   {:dt=>1619384400,
    :temp=>75.29,
    :feels_like=>73.42,
    :pressure=>1002,
    :humidity=>19,
    :dew_point=>30.43,
    :uvi=>5.93,
    :clouds=>11,
    :visibility=>10000,
    :wind_speed=>4.36,
    :wind_deg=>47,
    :wind_gust=>15.23,
    :weather=>[{:id=>801, :main=>"Clouds", :description=>"few clouds", :icon=>"02d"}],
    :pop=>0},
   {:dt=>1619388000,
    :temp=>75.63,
    :feels_like=>73.69,
    :pressure=>1000,
    :humidity=>17,
    :dew_point=>28.29,
    :uvi=>4.08,
    :clouds=>17,
    :visibility=>10000,
    :wind_speed=>2.01,
    :wind_deg=>304,
    :wind_gust=>18.07,
    :weather=>[{:id=>801, :main=>"Clouds", :description=>"few clouds", :icon=>"02d"}],
    :pop=>0},
   {:dt=>1619391600,
    :temp=>75.25,
    :feels_like=>73.24,
    :pressure=>999,
    :humidity=>16,
    :dew_point=>26.71,
    :uvi=>2.18,
    :clouds=>19,
    :visibility=>10000,
    :wind_speed=>2.98,
    :wind_deg=>314,
    :wind_gust=>19.06,
    :weather=>[{:id=>801, :main=>"Clouds", :description=>"few clouds", :icon=>"02d"}],
    :pop=>0},
   {:dt=>1619395200,
    :temp=>74.84,
    :feels_like=>72.68,
    :pressure=>997,
    :humidity=>14,
    :dew_point=>23.58,
    :uvi=>0.86,
    :clouds=>20,
    :visibility=>10000,
    :wind_speed=>3.53,
    :wind_deg=>229,
    :wind_gust=>16.28,
    :weather=>[{:id=>801, :main=>"Clouds", :description=>"few clouds", :icon=>"02d"}],
    :pop=>0},
   {:dt=>1619398800,
    :temp=>72.3,
    :feels_like=>69.94,
    :pressure=>996,
    :humidity=>15,
    :dew_point=>22.89,
    :uvi=>0.21,
    :clouds=>5,
    :visibility=>10000,
    :wind_speed=>4.25,
    :wind_deg=>210,
    :wind_gust=>9.55,
    :weather=>[{:id=>800, :main=>"Clear", :description=>"clear sky", :icon=>"01d"}],
    :pop=>0},
   {:dt=>1619402400,
    :temp=>68.23,
    :feels_like=>65.61,
    :pressure=>997,
    :humidity=>18,
    :dew_point=>23.23,
    :uvi=>0,
    :clouds=>7,
    :visibility=>10000,
    :wind_speed=>7.94,
    :wind_deg=>196,
    :wind_gust=>16.67,
    :weather=>[{:id=>800, :main=>"Clear", :description=>"clear sky", :icon=>"01n"}],
    :pop=>0},
   {:dt=>1619406000,
    :temp=>66.74,
    :feels_like=>63.91,
    :pressure=>999,
    :humidity=>17,
    :dew_point=>20.62,
    :uvi=>0,
    :clouds=>7,
    :visibility=>10000,
    :wind_speed=>13.98,
    :wind_deg=>203,
    :wind_gust=>24.2,
    :weather=>[{:id=>800, :main=>"Clear", :description=>"clear sky", :icon=>"01n"}],
    :pop=>0}]}
    @results = Weather.new(data)
  end

  it "returns all data as poros" do
    expect(@results.class).to eq(Weather)
    expect(@results.current_weather.class).to eq(Current)
    @results.daily_weather.each do |day|
      expect(day.class).to eq(Daily)
    end
    @results.hourly_weather.each do |hour|
      expect(hour.class).to eq(Hourly)
    end
  end
end
